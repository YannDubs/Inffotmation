summarise(count = sum(n)) %>%
spread(type,count,fill=0)
colnames(groupedIncidentShot) <- c("id","goalShot","shotoffShot","shotonShot")
player_stats %<>% left_join(groupedIncidentShot, by = c("player_api_id" = "id"))
player_stats %<>% left_join(groupedIncidentHeader, by = c("player_api_id" = "id"))
View(incidents)
player_stats[,c("goalShot","shotoffShot","shotonShot","goalHeader","shotoffHeader","shotonHeader")
][is.na(player_stats[,c("goalShot","shotoffShot","shotonShot","goalHeader","shotoffHeader","shotonHeader")])] <- 0
is.na(player_stats[,c("goalShot","shotoffShot","shotonShot","goalHeader","shotoffHeader","shotonHeader")])
any(is.na(player_stats[,c("goalShot","shotoffShot","shotonShot","goalHeader","shotoffHeader","shotonHeader")]))
write.csv(incidents,"data/incidents.csv", row.names = F)
write.csv(player_stats,"data/player_stats.csv", row.names = F)
write.csv(player_statsMult,"data/player_statsMult.csv", row.names = F)
write.csv(country,"data/country.csv", row.names = F)
write.csv(team,"data/team.csv", row.names = F)
View(league)
View(league)
View(player_stats)
View(incidents)
unique(incidents$league)
league        <- dbGetQuery(con,"SELECT * FROM League")
remove(groupedIncidents)
remove(groupedIncidentHeader)
remove(groupedIncidentShot)
groupedIncidents = incidents %>%
group_by(player1,type,subtype1) %>%
tally()
incidents %>% group_by(player1) %>% summarise(count = n())
test <- incidents %>% group_by(player1) %>% summarise(count = n())
View(test)
32+82+85
199/247
0.805668*67
1/247
0.004048583*57
test <- player_stats %>% mutate(missShot = shotonShot + shotoffShot, missShot = shotonHeader + shotoffHeader)
View(test)
test <- player_stats %>% mutate(missShot = shotonShot + shotoffShot, missHeader = shotonHeader + shotoffHeader)
test <- player_stats %>% mutate(missShot = shotonShot + shotoffShot, missHeader = shotonHeader + shotoffHeader, percentageShot = goalShot/missShot, percentageHeader = goalHeader/missHeader)
test <- player_stats %>% mutate(missShot = shotonShot + shotoffShot, missHeader = shotonHeader + shotoffHeader, percentageShot = goalShot/(missShot+goalShot), percentageHeader = goalHeader/(missHeader+goalHeader))
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
df <- dbGetQuery(con,"SELECT * FROM Match WHERE country_id IN ('1729','4769','7809','10257','21518') AND season IN ('2015/2016','2014/2015','2013/2014')")
View(df)
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
remove(list = ls())
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
panderOptions('table.split.table', Inf)
value_from_xpath  <- function(element, xpath, to.int = F, index = 1) {
xml_find_all(element, xpath) %>%
#if empty result return NA
{ifelse(length(.), xml_text(.[[index]]), NA)} %>%
# put value in integer
{ifelse(to.int, as.integer(.), .)}
}
node_to_dataframe <- function(n, key) {
tibble_(list(
id = ~value_from_xpath(n, './id', to.int = T),
type = ~value_from_xpath(n, './type'),
subtype1 = ~value_from_xpath(n, './subtype'),
subtype2 = ~value_from_xpath(n, paste0('./', key, '_type')),
player1 = ~value_from_xpath(n, './player1'),
player2 = ~value_from_xpath(n, './player2'),
team = ~value_from_xpath(n, './team'),
lon = ~value_from_xpath(n, './coordinates/value', to.int = T, index = 1),
lat = ~value_from_xpath(n, './coordinates/value', to.int = T, index = 2),
elapsed = ~value_from_xpath(n, './elapsed', T),
elapsed_plus = ~value_from_xpath(n, './elapsed_plus', T)
))
}
con <- dbConnect(SQLite(), dbname="./data/database.sqlite")
df <- dbGetQuery(con,"SELECT * FROM Match WHERE country_id IN ('1729','4769','7809','10257','21518') AND season IN ('2015/2016','2014/2015','2013/2014')")
matches$date <- as.Date(matches$date,format="%Y-%m-%d")
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
matches$date <- as.Date(matches$date,format="%Y-%m-%d")
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
nrow(incidents)
nrow(player_stats)
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
source('~/Desktop/GitHub/Infootmation/preProcessing.R', echo=TRUE)
View(team)
View(player_stats)
install.packages('rvest')
install.packages('stringr')
library(rvest)
library(stringr)
url <- 'http://www.squawka.com/players/robert-lewandowski/stats'
webpage <- read_html(url)
sb_table <- html_nodes(webpage, 'table')
sb <- html_table(sb_table)[[1]]
head(sb)
View(sb)
url <- 'http://www.squawka.com/players/robert-lewandowski/stats'
webpage <- html(url)
webpage <- read_html(url)
webpage  %>%
html_node(".text-center , .pl a") %>%
html_text()
webpage  %>%
html_node(".team-league") %>%
html_text()
View(player_stats)
webpage  %>%
html_node(".pl a") %>%
html_text()
url <- 'http://sofifa.com/player/188545'
webpage <- read_html(url)
webpage  %>%
html_node(".pl a") %>%
html_text()
webpage  %>%
html_node("td+ td li") %>%  html_text()
webpage  %>%
html_node("td li") %>%  html_text()
webpage  %>%
html_node("td") %>%  html_text()
webpage  %>%
html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
webpage  %>% html_node(".text-center~ .text-center+ .text-center") %>%  html_text()
webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
webpage  %>% html_node("td:nth-child(4) li:nth-child(3)") %>%  html_text()
webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
jerseyString <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jerseyString <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jerseyString <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jerseyNum <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
jerseyNum
webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
gsub("^.*D([0-9]+).*$", "\\1", positionRaw)
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
gsub("^.*D([0-9]+).*$", "\\1", positionRaw)
gsub("\nPosition\n", "", positionRaw)
gsub("\nPosition\n", "", positionRaw)[0,1]
gsub("\nPosition\n", "", positionRaw)[0:1]
gsub("\nPosition\n", "", positionRaw)[0]
gsub("\nPosition\n", "", positionRaw)[1]
gsub("\nPosition\n", "", positionRaw)[1:2]
substr(gsub("\nPosition\n", "", positionRaw), 1, 3)
substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
?substr
regexpr(' ', wageRaw)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
regexpr(' ', wageRaw)
regexpr(" ", wageRaw)
regexpr("\ ", wageRaw)
regexpr("n", wageRaw)
substr(wageRaw, 9, -2)
substr(wageRaw, 9, -1)
substr(wageRaw, 9, 11)
substr(wageRaw, 9, 12)
substr(wageRaw, 9, wageRaw.length)
wageRaw.length()
nchar(wageRaw)
position <- substr(wageRaw, 9, nchar(wageRaw)-1)
position
webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(wageRaw, 10, nchar(valueRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(wageRaw, 10, nchar(valueRaw)-1)
> value
value
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
value
webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
substr(countryRaw, 2, nchar(countryRaw)-2)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
substr(countryRaw, 2, nchar(countryRaw)-2)
substr(countryRaw, 2, nchar(countryRaw)-1)
webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
team
View(player_stats)
head(player_stats)
test <- head(player_stats)
test <- head(player_stats)
for (id in test$player_fifa_api_id){
showValue(id)
}
test <- head(player_stats)
for (id in test$player_fifa_api_id){
print(id)
}
url <- 'http://sofifa.com/player/' + id
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
url
test <- head(player_stats)
for (id in test$player_fifa_api_id){
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
test[1,]
test[0,]
nrows(test)
nrow(test)
test <- head(player_stats)
for (i=1; i<= nrow(test); ++i ){
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
for (i in 1:nrow(test)){
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
player_stats[i,player_api_id]
player_stats[i,"player_api_id""]
""
player_stats[i,"player_api_id"]
test <- head(player_stats)
for (i in 1:nrow(test)){
id = player_stats[i,"player_api_id"]
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
test <- head(player_stats)
for (i in 1:nrow(test)){
id = player_stats[i,"player_api_id"]
print(id)
print(i)
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
test <- head(player_stats)
for (i in 1:nrow(test)){
id = test[i,"player_api_id"]
print(id)
print(i)
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
url
test <- head(player_stats)
for (i in 1:nrow(test)){
id = test[i,"player_fifa_api_id"]
print(id)
print(i)
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
jersey <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
position <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
wage <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
value <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
country <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
team <- substr(teamRaw, 2, nchar(teamRaw)-1)
print(team)
}
test <- head(player_stats)
test$jersey <- 0
test$position <- 0
test$wage <- 0
test$value <- 0
test$country <- 0
test$team <- 0
test[i,"team"]
test[i,"team"] <- 2
test[i,"team"]
test <- head(player_stats)
test$jersey <- 0
test$position <- 0
test$wage <- 0
test$value <- 0
test$country <- 0
test$team <- 0
for (i in 1:nrow(test)){
id = test[i,"player_fifa_api_id"]
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
test[i,"jersey"] <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jersey)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
test[i,"position"] <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
test[i,"wage"] <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
test[i,"value"] <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
test[i,"country"] <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
test[i,"team"] <- substr(teamRaw, 2, nchar(teamRaw)-1)
}
test
test <- head(player_stats)
test$jersey <- 0
test$position <- 0
test$wage <- 0
test$value <- 0
test$country <- 0
test$team <- 0
for (i in 1:nrow(test)){
id = test[i,"player_fifa_api_id"]
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
test[i,"jersey"] <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jerseyRaw)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
test[i,"position"] <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
test[i,"wage"] <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
test[i,"value"] <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
test[i,"country"] <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
test[i,"team"] <- substr(teamRaw, 2, nchar(teamRaw)-1)
}
test <- head(player_stats)
test$jersey <- 0
test$position <- 0
test$wage <- 0
test$value <- 0
test$country <- 0
test$team <- 0
for (i in 1:nrow(test)){
id = test[i,"player_fifa_api_id"]
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
test[i,"jersey"] <- as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jerseyRaw)), "")))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
test[i,"position"] <- substr(gsub("\nPosition\n", "", positionRaw), 1, 2)
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
test[i,"wage"] <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
test[i,"value"] <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
test[i,"country"] <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
test[i,"team"] <- substr(teamRaw, 2, nchar(teamRaw)-1)
}
webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
as.numeric(unlist(strsplit(gsub("[^0-9]", "", unlist(jerseyRaw)), "")))
as.numeric(strsplit(gsub("[^0-9]", "", unlist(jerseyRaw)), ""))
substr(gsub("\nPosition\n", "", jerseyRaw), 1, 2)
substr(gsub("\nJersey number\n", "", jerseyRaw), 1, 2)
jerseyRaw
jerseyRaw <- "\nJersey number\n2 "
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
test[i,"jersey"] <- substr(gsub("\nJersey number\n", "", jerseyRaw), 1, 2)
test[i,"jersey"
]
gsub("\nJersey number\n", "", jerseyRaw)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
gsub(" ", "", gsub("\nJersey number\n", "", jerseyRaw))
wageRaw
countryRaw
webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
url <- 'http://sofifa.com/player/188545'
webpage <- read_html(url)
webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
substr(countryRaw, 2, nchar(countryRaw)-1)
webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
test <- head(player_stats)
test$jersey <- 0
test$position <- 0
test$wage <- 0
test$value <- 0
test$country <- 0
test$team <- 0
for (i in 1:nrow(test)){
id = test[i,"player_fifa_api_id"]
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
test[i,"jersey"] <- gsub(" ", "", gsub("\nJersey number\n", "", jerseyRaw))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
test[i,"position"] <- gsub(" ", "", gsub("\nPosition\n", "", positionRaw))
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
test[i,"wage"] <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
test[i,"value"] <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
test[i,"country"] <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
test[i,"team"] <- substr(teamRaw, 2, nchar(teamRaw)-1)
}
test
test <- player_stats[50,]
test <- player_stats[1:50,]
test$jersey <- 0
test$position <- 0
test$wage <- 0
test$value <- 0
test$country <- 0
test$team <- 0
for (i in 1:nrow(test)){
id = test[i,"player_fifa_api_id"]
url <- paste(c('http://sofifa.com/player/', id), collapse = "")
webpage <- read_html(url)
jerseyRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(4)") %>%  html_text()
test[i,"jersey"] <- gsub(" ", "", gsub("\nJersey number\n", "", jerseyRaw))
positionRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(3)") %>%  html_text()
test[i,"position"] <- gsub(" ", "", gsub("\nPosition\n", "", positionRaw))
wageRaw <- webpage  %>% html_node(".text-center:nth-child(4)") %>%  html_text()
test[i,"wage"] <- substr(wageRaw, 9, nchar(wageRaw)-1)
valueRaw <- webpage  %>% html_node(".text-center:nth-child(3)") %>%  html_text()
test[i,"value"] <- substr(valueRaw, 10, nchar(valueRaw)-1)
countryRaw <- webpage  %>% html_node("td:nth-child(4) li:nth-child(1)") %>%  html_text()
test[i,"country"] <- substr(countryRaw, 2, nchar(countryRaw)-1)
teamRaw <- webpage  %>% html_node("td:nth-child(3) li:nth-child(1)") %>%  html_text()
test[i,"team"] <- substr(teamRaw, 2, nchar(teamRaw)-1)
}
View(test)
country        <- dbGetQuery(con,"SELECT * FROM Country")
View(country)
View(player_statsMult)
View(player_stats)
View(player_stats)
View(player_statsMult)
?read.csv
df <- read.csv("data/player_stats.csv",header = TRUE)
View(df)
source('~/Desktop/GitHub/Infootmation/addInfoPlayer.R', echo=TRUE)
source('~/Desktop/GitHub/Infootmation/addInfoPlayer.R', echo=TRUE)
View(test)
remove(list=ls())
source('~/Desktop/GitHub/Infootmation/addInfoPlayer.R', echo=TRUE)
